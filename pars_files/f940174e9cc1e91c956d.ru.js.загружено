(window.__LOADABLE_LOADED_CHUNKS__=window.__LOADABLE_LOADED_CHUNKS__||[]).push([["map-features"],{103:function(e,t,n){"use strict";var o=n(6),r=n(4),a=n(8),i=n(68),s=function(e){function t(){var t;return(t=e.apply(this,arguments)||this)._getStyle=function(){var e=t.props;return{objectFit:e.backgroundSize||"cover",backgroundColor:"contain"===e.backgroundSize?"#fff":void 0}},t}return Object(o.a)(t,e),t.prototype.render=function(){var e=this.props;return r.createElement(i.a,{immediately:e.renderImmediately},r.createElement("img",{width:"100%",height:"100%",src:e.src,alt:e.alt,style:this._getStyle(),loading:e.renderImmediately?void 0:"lazy"}))},t}(r.PureComponent);t.a=Object(a.b)(s)},1148:function(e,t,n){"use strict";n.r(t);var o=n(10),r=n(6),a=n(4),i=n(11),s=n(22),c=n(14),l=n(8),u=n(19),d=n(588),p=n(2995),m=n(2981),h={setRegion:s.a.setRegion,setEmergencyNotifications:s.a.setEmergencyNotifications},f=Object(c.a)(i.b(function(e){return{region:e.mapRegion,mapLocation:e.map.location}},h),l.b),v=10,b=[.05,.05],E=function(e){function t(t){var n;return(n=e.call(this,t)||this)._onLocationChange=function(){var e=n.props;if(e.mapLocation.zoom>=v){var t=n.state.knownBounds;if(t&&Object(p.a)(t,e.mapLocation.center))return;u.a.cancel(n._regionAction),n._regionAction=u.a.create(d.a.getLayer(Object(o.a)({layer:"geoalias"},e.mapLocation),e.config),{success:n._onLayerLoaded})}else n._updateRegion(void 0),e.setEmergencyNotifications(void 0),n.setState({knownBounds:void 0})},n._onLayerLoaded=function(e){var t=n.props,o=e&&e.region,r=o&&o.bounds||Object(m.a)({center:t.mapLocation.center,span:b});n.setState({knownBounds:r}),n._updateRegion(o),t.setEmergencyNotifications(null==e?void 0:e.notifications)},n._updateRegion=function(e){var t=n.props,o=e?e.id:null;(t.region?t.region.id:null)!==o&&t.setRegion(e)},n.state={knownBounds:t.region&&t.region.bounds},n}Object(r.a)(t,e);var n=t.prototype;return n.componentDidMount=function(){this.props.region||this._onLocationChange()},n.componentDidUpdate=function(e){e.mapLocation!==this.props.mapLocation&&this._onLocationChange()},n.componentWillUnmount=function(){u.a.cancel(this._regionAction)},n.render=function(){return null},t}(a.Component);E.displayName="GeoAliasesComponent",t.default=f(E)},1149:function(e,t,n){"use strict";n.r(t);var o=n(6),r=n(4),a=n.n(r),i=n(11),s=n(16),c=n(46),l=n(26),u=n(64),d=n(235),p=Object(l.a)({resolved:{},chunkName:function(){return"preview"},isReady:function(e){var t=this.resolve(e);return!1!==this.resolved[t]&&!!n.m[t]},importAsync:function(){return n.e("preview").then(n.bind(null,1215))},requireAsync:function(e){var t=this,n=this.resolve(e);return this.resolved[n]=!1,Promise.resolve(this.importAsync(e)).then(function(e){return t.resolved[n]=!0,e})},requireSync:function e(t){var o=this.resolve(t);return n(o)},resolve:function e(){return 1215}}),m=Object(l.a)({resolved:{},chunkName:function(){return"preview"},isReady:function(e){var t=this.resolve(e);return!1!==this.resolved[t]&&!!n.m[t]},importAsync:function(){return n.e("preview").then(n.bind(null,1326))},requireAsync:function(e){var t=this,n=this.resolve(e);return this.resolved[n]=!1,Promise.resolve(this.importAsync(e)).then(function(e){return t.resolved[n]=!0,e})},requireSync:function e(t){var o=this.resolve(t);return n(o)},resolve:function e(){return 1326}}),h=Object(l.a)({resolved:{},chunkName:function(){return"preview"},isReady:function(e){var t=this.resolve(e);return!1!==this.resolved[t]&&!!n.m[t]},importAsync:function(){return n.e("preview").then(n.bind(null,1327))},requireAsync:function(e){var t=this,n=this.resolve(e);return this.resolved[n]=!1,Promise.resolve(this.importAsync(e)).then(function(e){return t.resolved[n]=!0,e})},requireSync:function e(t){var o=this.resolve(t);return n(o)},resolve:function e(){return 1327}}),f={showUriPreview:d.a.showUriPreview,hidePreview:d.a.hidePreview,cancelHidePreview:d.a.cancelHidePreview},v=16,b=i.b(function(e){var t=e.mapObjectPreview;if(t&&"type"in t&&"stop"===t.type){var n,o=s.h(e,"masstransit"),r=null==o?void 0:null===(n=o.stops)||void 0===n?void 0:n.data,a=(null==r?void 0:r.id)?c.c(r.id):void 0;if(t.uri===a||e.map.location.zoom<v)return{}}var i=s.h(e,"routes");return e.ruler.isEnabled||e.panoramas.isLayerEnabled||e.photos.isLayerEnabled||e.mrc.isLayerEnabled||e.map.isEditing||Boolean(null==i?void 0:i.routePoints.some(function(e){return!e.coords}))?{}:{preview:t}},f),E=function(e){function t(t){var n;return(n=e.call(this,t)||this)._onDocumentClick=function(){n.props.hidePreview(!0),n.setState({isOverPreview:!1})},n._onPoiMouseLeave=function(e){var t=n.props,o=n.state,r=t.preview,a=_(e);!o.isPoiTriggered||o.isOverPreview||a&&r&&"uri"in r&&a.uri!==r.uri||t.hidePreview()},n._onPoiMouseEnter=function(e){var t=_(e);t&&(n.props.showUriPreview(t.uri,t.coordinates),n.setState({isPoiTriggered:!0}))},n._hidePreview=function(){n.props.preview&&n.props.hidePreview()},n._onPreviewMouseEnter=function(){n.props.cancelHidePreview(),n.setState({isOverPreview:!0})},n._onPreviewMouseLeave=function(){n.props.hidePreview(),n.setState({isOverPreview:!1})},n._renderPreview=function(){var e=n.props.preview;if(e&&"type"in e){if("realty"===e.type)return r.createElement(h,{key:e.coordinates.join(","),businessId:e.businessId,coordinates:e.coordinates,building:e.building,url:e.url,onMouseEnter:n._onPreviewMouseEnter,onMouseLeave:n._onPreviewMouseLeave});var t=e.uri,o=e.coordinates;return"business"===e.type?r.createElement(p,{result:e.data,from:e.from,offsets:e.offsets,key:t,poiCoordinates:o,onMouseEnter:n._onPreviewMouseEnter,onMouseLeave:n._onPreviewMouseLeave}):r.createElement(m,{stop:e.data,key:t})}},n.state={},n}Object(o.a)(t,e);var n=t.prototype;return n.componentDidMount=function(){window.document.addEventListener("click",this._onDocumentClick)},n.componentDidUpdate=function(){this.state.isPoiTriggered&&!this.props.preview&&this.setState({isPoiTriggered:!1})},n.componentWillUnmount=function(){window.document.removeEventListener("click",this._onDocumentClick),this.props.cancelHidePreview()},n.render=function(){return r.createElement(r.Fragment,null,this._renderPreview(),r.createElement(u.default,{layer:"any",onMouseEnter:this._onPoiMouseEnter,onMouseLeave:this._onPoiMouseLeave,onUpdate:this._hidePreview}))},t}(r.PureComponent);function _(e){var t,n;if("hotspot"===(null==e?void 0:e.type)&&"Point"===(null===(t=e.feature.geometry)||void 0===t?void 0:t.type)){var o=e.feature.properties.uri,r=null===(n=e.feature.geometry)||void 0===n?void 0:n.coordinates;return r&&(c.j(o)||c.m(o))?{uri:o,coordinates:r}:void 0}}t.default=b(E)},1150:function(e,t,n){"use strict";n.r(t);var o=n(6),r=n(4),a=n(11),i=n(14),s=n(8),c=n(282),l=n(588),u=n(31),d=n(420),p=n(9),m=n(118),h={updateLayerAvailability:c.a.updateLayerAvailability,openCard:m.a.openCard},f=Object(i.a)(a.b(function(e){var t=e.parking,n=e.map;return{isLayerShown:t.isLayerShown,isLayerEnabled:t.isLayerEnabled,zoom:n.location.zoom,center:t.center}},h),Object(u.b)({shouldWait:!0}),s.b),v=function(e){function t(){var t;return(t=e.apply(this,arguments)||this)._analyticsRef=r.createRef(),t._checkLayer=function(){var e=t.props,n=l.a.checkStaticZoomRange("carparks",e.zoom,e.config);n!==e.isLayerEnabled&&e.updateLayerAvailability({isLayerEnabled:n})},t._onHotspotClick=function(e,n){var o,r=t.props,a=e.properties.uri,i=e.geometry&&e.geometry.coordinates||n.coordinates;(r.openCard({coordinates:i,from:"poi",hotspotProperties:e.properties,uri:a}),t._analyticsRef.current)&&t._analyticsRef.current.logEvent("click",{uri:a,coordinates:i,type:null===(o=e.properties.vectorMetadata)||void 0===o?void 0:o.get("type")})},t}Object(o.a)(t,e);var n=t.prototype;return n.componentDidMount=function(){this._checkLayer()},n.componentDidUpdate=function(e){e.zoom!==this.props.zoom&&this._checkLayer()},n.render=function(){var e=this.props;return e.isLayerEnabled&&e.isLayerShown?r.createElement(p.a,{name:"parking_layer",nodeRef:this._analyticsRef},r.createElement(d.a,{layer:"carparks",onClick:this._onHotspotClick})):null},t}(r.Component);v.displayName="ParkingComponent",t.default=f(v)},1210:function(e,t,n){"use strict";n.r(t);var o=n(6),r=(n(2430),n(4)),a=n(11),i=n(2978),s=n(22),c=n(7),l=n(0),u=n(9),d=n(23),p=n(67),m=n(20),h=n(590),f=n(84),v=n(127),b={openShare:s.a.openShare,switchRuler:s.a.switchRuler,openCommonFeedback:f.a.openCommonFeedback,openMapEditFeedback:f.a.openMapEditFeedback},E=a.b(function(e){var t=e.config,n=Object(p.a)(e,{format:"query"}),o={ll:Object(i.a)(e.map.location.center),z:e.map.location.zoom};return{printUrl:t.uatraits.isTablet?void 0:m.n(n,t),metroUrl:m.w(t.hosts.metro,o),apiUrl:t.apiManual.mapsApiUrl?t.apiManual.mapsApiUrl+"/?utm_source=sidesection&utm_medium=referral&utm_campaign=b2bpromo":void 0,isRulerEnabled:e.ruler.isEnabled,isRulerBlocked:Object(h.a)(e)}},b),_=Object(c.a)("map-tools-list"),g=function(e){function t(){var t;return(t=e.apply(this,arguments)||this)._onRulerClick=function(e){e.stopPropagation(),t.props.switchRuler()},t._onPrintClick=function(){l.a.set("print_url",t.props.printUrl)},t._renderList=function(){var e=t.props;return r.createElement(u.a,{name:"tools_list"},e.showRuler?r.createElement(u.a,{name:"ruler",logClick:!0},r.createElement(v.a,{icon:"ruler",onClick:t._onRulerClick,active:e.isRulerEnabled,disabled:e.isRulerBlocked},"Линейка")):null,e.printUrl?r.createElement(u.a,{name:"print",logClick:!0},r.createElement(v.a,{icon:"printer",link:{href:e.printUrl,target:"_blank"},onClick:t._onPrintClick},"Печать")):null,r.createElement(u.a,{name:"share",logClick:!0},r.createElement(v.a,{icon:"share",onClick:e.openShare},"Поделиться")),r.createElement(u.a,{name:"metro",logClick:!0},r.createElement(v.a,{icon:"subway-fallback",link:{href:e.metroUrl,target:"_blank"}},"Схема метро")),e.apiUrl?r.createElement(u.a,{name:"maps_api",logClick:!0},r.createElement(v.a,{icon:"api-logo",link:{href:e.apiUrl,target:"_blank"}},"Карты для вашего сайта")):null,r.createElement(u.a,{name:"map_edit",logClick:!0},r.createElement(v.a,{icon:"edit-nofill",onClick:function(){return e.openMapEditFeedback({context:{formContextId:"map.controls"}})}},"Редактировать карту")),r.createElement(u.a,{name:"feedback",logClick:!0},r.createElement(v.a,{icon:"org-info",onClick:e.openCommonFeedback},"Сообщить об ошибке")))},t}return Object(o.a)(t,e),t.prototype.render=function(){var e=this.props;return r.createElement(d.a,e.popupProps,r.createElement("div",{className:_(),onClick:e.onContentClick},this._renderList()))},t}(r.Component);t.default=E(g)},127:function(e,t,n){"use strict";var o=n(13),r=n(6),a=(n(212),n(4)),i=n(7),s=n(32),c=Object(i.a)("list-item-view"),l=function(e){function t(){var t;return(t=e.apply(this,arguments)||this)._onClick=function(e){var n,o;null===(n=(o=t.props).onClick)||void 0===n||n.call(o,e)},t._renderIconContent=function(){var e=t.props,n=e.icon;if(!n)return null;var o=c("icon")+(e.iconClassName?" "+e.iconClassName:"");return a.createElement("div",{className:c("icon-content"),style:e.iconStyle},"function"==typeof n?n(o):a.createElement(s.a,{name:n,size:24,inline:!0,className:o}))},t._renderContent=function(){var e=t.props;return a.createElement("div",{className:c("content")},t.props.children,e.subtitle?a.createElement("div",{className:c("subtitle")},e.subtitle):null)},t._renderRightContent=function(){var e=t.props.renderRightContent;return e?a.createElement("div",{className:c("right-content")},e()):null},t}return Object(r.a)(t,e),t.prototype.render=function(){var e=this.props,t=e.link?"a":"label";return a.createElement(t,Object(o.a)({},e.link,{className:c({clickable:Boolean(e.onClick||e.link||e.clickable),active:e.active,disabled:e.disabled,theme:e.theme,size:e.size||"list",border:e.border,toggled:e.toggled}),onClick:this._onClick}),this._renderIconContent(),this._renderContent(),this._renderRightContent())},t}(a.PureComponent);t.a=l},1300:function(e,t,n){"use strict";n.r(t);var o=n(13),r=n(6),a=n(4),i=n(11),s=n(2982),c=n(232),l=n(14),u=n(8),d=n(22),p=n(118),m=n(111),h=n(160),f=n(64),v=(n(1574),n(7)),b=n(35),E=n(23),_=function(e){function t(){var t;return(t=e.apply(this,arguments)||this)._ref=null,t}Object(r.a)(t,e);var n=t.prototype;return n.componentDidUpdate=function(e){var t=e.showAt,n=this.props.showAt;t.left===n.left&&t.top===n.top||this.forceUpdate()},n.render=function(){var e=this,t=this.props,n={position:"absolute",visibility:"hidden",top:t.showAt.top,left:t.showAt.left};return a.createElement(a.Fragment,null,a.createElement(b.a,null,a.createElement("div",{style:n,ref:function(t){return e._ref=t}})),a.createElement(E.a,Object(o.a)({getTarget:function(){return e._ref}},t)))},t}(a.Component),g=n(66),y=n.n(g),k=n(9),C=n(127),w=["bottom-right","right-bottom","bottom-left","left-bottom","right-top","top-right","left-top","top-left"],S=Object(v.a)("context-menu"),L=function(e){function t(){var t;return(t=e.apply(this,arguments)||this)._close=function(){t.props.onClose()},t._onItemClick=function(e){t._close(),t.props.onItemClick(e)},t._renderItem=function(e){return a.createElement(k.a,{key:e.id,name:"item",nodeState:{id:e.id},logClick:!0,metrikaGoal:t.props.metrikaGoal},a.createElement(C.a,{icon:e.icon,onClick:function(){return t._onItemClick(e)}},e.text))},t}return Object(r.a)(t,e),t.prototype.render=function(){var e,t=this.props,n=a.createElement("div",{className:S()},t.items.map(this._renderItem));return t.isPhone?a.createElement(y.a,{isShown:t.isShown,onClose:this._close,swipeable:!0,stopPropagation:!0},n):a.createElement(_,{isShown:t.isShown,showAt:{left:t.coordinates[0],top:t.coordinates[1]},position:w,offset:{main:4,side:4},showArrow:!1,onClose:this._close,onScroll:null!==(e=t.onScroll)&&void 0!==e?e:"close",type:"transparent"},n)},t}(a.Component);L.displayName="ContextMenu";var P=L,M=n(16),R=n(590),T=n(251),O=n(84),N=4,j=300,I=500,A=2,D=[{id:"what-is-here",icon:"about",text:"Что здесь?"},{id:"route-to-here",icon:"route-to",text:"Маршрут сюда"},{id:"route-from-here",icon:"route-from",text:"Маршрут отсюда"},{id:"add-object",icon:"add-place",text:"Добавить объект"}],z={id:"enable-ruler",icon:"ruler",text:"Линейка"},x={id:"map-edit",icon:"nmap",text:"Редактировать карту"},F={openCard:p.a.openCard,buildRouteTo:m.a.buildRouteTo,buildRouteFrom:m.a.buildRouteFrom,switchRuler:d.a.switchRuler,updateRuler:d.a.updateRuler,openAddObjectFeedback:O.a.openAddObjectFeedback,openMapEditFeedback:O.a.openMapEditFeedback},U=Object(l.a)(i.b(function(e){M.h(e,"routes");return{isPhone:!1,canShow:!e.config.query.embed&&!0,mapLocation:e.map.location,ruler:e.ruler,isRulerBlocked:Object(R.a)(e),isMapEditing:e.map.isEditing}},F),u.b),B=function(e){function t(t){var n;return(n=e.call(this,t)||this)._onDocumentMousedown=function(){n._canBeShown=n.props.canShow},n._onMouseUp=function(e,t,o){o.button===A&&!n._longTapTimer&&n._canBeShown&&(n._rightClickTimer?(clearTimeout(n._rightClickTimer),n._rightClickTimer=void 0):n._rightClickTimer=window.setTimeout(function(){n._open(t.coordinates,t.screenCoordinates),n._rightClickTimer=void 0},j))},n._onTouchStart=function(e,t){n._canBeShown&&(n._touchFrom=t.screenCoordinates,n._touchTo=n._touchFrom,window.clearTimeout(n._longTapTimer),n._longTapTimer=window.setTimeout(function(){n._longTapTimer=void 0,Object(s.a)(n._touchTo,n._touchFrom)<=N&&n._open(t.coordinates,t.screenCoordinates)},I))},n._onContainerTouchMove=function(e){n._touchTo=e},n._onTouchEnd=function(e,t,o){n.state.isShown&&o.preventDefault(),window.clearTimeout(n._longTapTimer),n._longTapTimer=void 0},n._onUpdate=function(){window.clearTimeout(n._longTapTimer),n._longTapTimer=void 0},n._open=function(e,t){n.props.canShow&&n.setState({isShown:!0,coordinates:e,screenCoordinates:t})},n._close=function(){n.setState({isShown:!1})},n._onItemClick=function(e){n._close();var t=n.state.coordinates,o=n.props,r=o.mapLocation.zoom;switch(e.id){case"what-is-here":o.openCard({coordinates:t,from:"whatshere",zoom:r},{mobileViewState:"mini"});break;case"route-to-here":o.buildRouteTo({coords:t,value:""});break;case"route-from-here":o.buildRouteFrom({coords:t,value:""});break;case"map-edit":o.openMapEditFeedback({coordinates:t,context:{formContextId:"map.context"}});break;case"enable-ruler":o.switchRuler(),0===o.ruler.points.length&&o.updateRuler([{coordinates:t,distance:0,showBalloon:!1}]);break;case"add-object":o.openAddObjectFeedback({coordinates:t,type:"object/add",context:{formContextId:"map.context"}})}},n._getEventHandlers=function(e){var t={onMouseUp:n._onMouseUp};if(n.props.config.uatraits.isMobile){var o=e.has.touch;t[o?"onTouchStart":"onPointerDown"]=n._onTouchStart,t[o?"onContainerTouchMove":"onContainerPointerMove"]=n._onContainerTouchMove,t[o?"onTouchEnd":"onPointerUp"]=n._onTouchEnd,t[o?"onTouchCancel":"onPointerCancel"]=n._onTouchEnd}return t},n._renderMenu=function(){var e=n.props,t=n.state;if(!t.screenCoordinates)return null;var o=[].concat(D);return e.config.hosts.nmaps&&o.push(x),e.isPhone||e.ruler.isEnabled||e.isRulerBlocked||o.push(z),a.createElement(h.default,{name:"context_menu"},a.createElement(P,{key:t.coordinates.join(","),isPhone:!1,isShown:t.isShown,coordinates:t.screenCoordinates,items:o,onItemClick:n._onItemClick,onClose:n._close,onScroll:"reposition"}))},n.state={isShown:!1,coordinates:null,screenCoordinates:null},n}Object(r.a)(t,e);var n=t.prototype;return n.componentDidMount=function(){window.document.addEventListener("mousedown",this._onDocumentMousedown,!0),window.document.addEventListener("touchstart",this._onDocumentMousedown,!0)},n.componentDidUpdate=function(e){if(this.props.mapLocation!==e.mapLocation){if(!this.state.coordinates)return this._close();var t=Object(c.a)(this.props.mapLocation.center,this.props.mapLocation.zoom),n=Object(c.a)(e.mapLocation.center,e.mapLocation.zoom);Object(s.a)(t,n)>=N&&this._close()}},n.componentWillUnmount=function(){window.clearTimeout(this._rightClickTimer),window.clearTimeout(this._longTapTimer),window.document.removeEventListener("mousedown",this._onDocumentMousedown,!0),window.document.removeEventListener("touchstart",this._onDocumentMousedown,!0)},n.render=function(){var e=this;return this.props.isMapEditing?null:a.createElement(a.Fragment,null,this._renderMenu(),a.createElement(T.a,null,function(t){return a.createElement(f.default,Object(o.a)({layer:"any"},e._getEventHandlers(t),{onUpdate:e._onUpdate}))}))},t}(a.Component);t.default=U(B)},1315:function(e,t,n){"use strict";n.r(t);var o=n(6),r=(n(2424),n(4)),a=n(11),i=n(7),s=n(14),c=n(9),l=n(22),u=n(23),d=n(43),p=n(66),m=n.n(p),h=n(115),f=n(296),v=n(382),b=n(750),E=n(282),_=n(129),g=n(590),y=(n(2426),["map","satellite","hybrid"]),k={hybrid:"Гибрид",map:"Схема",satellite:"Спутник"},C=Object(i.a)("map-layers-selector"),w=function(e){function t(t){var n;return(n=e.call(this,t)||this)._ref=r.createRef(),n._renderLayer=function(e){var t=n.props,o=e===t.layer,a={layer:e,selected:o};return r.createElement(c.a,{key:e,name:"layer",nodeState:a,logClick:!0},r.createElement("div",{className:C("layer",a),onClick:function(){return t.onChange(e)}},k[e]))},n._renderPlate=function(){var e=n.state.layerControlWidth;if(!e)return null;var t=n.props.layer,o=e*y.indexOf(t);return r.createElement("div",{className:C("plate"),style:{transform:"translateX("+o+"px)"}})},n.state={},n}Object(o.a)(t,e);var n=t.prototype;return n.componentDidMount=function(){var e,t,n=null===(e=this._ref)||void 0===e?void 0:null===(t=e.current)||void 0===t?void 0:t.scrollWidth;n&&this.setState({layerControlWidth:n/y.length})},n.render=function(){var e=this.props;return r.createElement("div",{className:C({size:e.size}),ref:this._ref},this._renderPlate(),y.map(this._renderLayer))},t}(r.Component),S=n(447),L=(n(2428),n(52)),P=n.n(L),M=n(250),R=(n(36),n(125)),T=n(83),O=n(32),N=n(127),j=n(997),I=n(172),A=n(45),D=n(38),z={updateFolderTags:_.a.updateFolderTags},x=a.b(function(e){return{config:e.config,isActionInProgress:Boolean(e.bookmarks.currentAction&&e.bookmarks.currentAction.inProgress),rootFolder:e.bookmarks.rootFolder}},z),F=Object(i.a)("bookmarks-layers-menu-view"),U=x(function(e){function t(){var t;return(t=e.apply(this,arguments)||this)._cacheId=P.a.v4(),t._onChange=function(e,n){var o=t.props,r=n.tags||[];e?r.push(R.a.FOLDER_TAGS.SHOW_ON_MAP):r=r.filter(function(e){return e!==R.a.FOLDER_TAGS.SHOW_ON_MAP}),o.updateFolderTags({folderId:n.id,tags:r})},t._renderItem=function(e){var n,o=Boolean(null===(n=e.tags)||void 0===n?void 0:n.includes(R.a.FOLDER_TAGS.SHOW_ON_MAP)),a=t.props.config,i=Object(T.l)(e,a);return r.createElement(N.a,{key:e.id,icon:function(){return r.createElement(M.a,{id:e.id,checked:o,onChange:function(n){return t._onChange(n,e)}})},clickable:!0},r.createElement("div",{className:F("text"),title:i},i))},t._renderHeader=function(){var e=t.props;return r.createElement("div",{className:F("header")},r.createElement(O.a,{inline:!0,name:"back",size:24,className:F("back"),onClick:e.onClose}),r.createElement("div",{className:F("title")},"Закладки"),null)},t}return Object(o.a)(t,e),t.prototype.render=function(){var e=this,t=this.props;return t.rootFolder?r.createElement(j.a,{isShown:t.isShown,popupProps:t.popupProps,onClose:t.onClose},function(n){var o=n.onScroll;return r.createElement("div",{className:F()},r.createElement(I.a,{onScroll:o,width:"dynamic",cacheKey:e._cacheId},r.createElement(A.a,{position:"top",border:"never"},e._renderHeader()),r.createElement("div",{className:F("body")},t.rootFolder.children.map(e._renderItem))),t.isActionInProgress?r.createElement("div",{className:F("loading-indicator")},r.createElement("div",{className:F("spinner")},r.createElement(D.a,{view:"small"}))):null)}):null},t}(r.Component)),B=n(1136),W=.2,H={updateMap:l.a.updateMap,toggleTrafficLayer:f.a.toggle,toggleMasstransitLayer:h.a.toggleLayer,toggleParkingLayer:E.a.toggleLayer,initBookmarksManager:_.a.initBookmarksManager,checkAuthorization:l.a.checkAuthorization,switchRuler:l.a.switchRuler,enableMrcLayer:S.a.enableLayer,disableMrcLayer:S.a.disableLayer,togglePanoramasPhotosLayer:l.a.togglePanoramasPhotosLayer,updateMapControls:l.a.updateMapControls},q=Object(s.a)(a.b(function(e){var t,n;return{config:e.config,type:e.map.type,trafficLevel:e.traffic.level,isTrafficLayerEnabled:e.traffic.isLayerEnabled,isMasstransitLayerShown:e.masstransit.isLayerShown,isMasstransitLayerEnabled:e.masstransit.isLayerEnabled,isMasstransitLayerEnabledOnAnotherZoom:e.masstransit.isLayerEnabledOnAnotherZoom,isParkingLayerShown:e.parking.isLayerShown,isParkingLayerEnabled:e.parking.isLayerEnabled,isRulerEnabled:e.ruler.isEnabled,isRulerBlocked:Object(g.a)(e),isPanoramasPhotosLayerEnabled:e.panoramas.isLayerEnabled||e.photos.isLayerEnabled,isPanoramasLayerEnabled:e.panoramas.isLayerEnabled,isPanoramasLayerAvailable:e.panoramas.isStreetLayerAvailable||e.panoramas.isAirLayerAvailable,isPhotosLayerEnabled:e.photos.isLayerEnabled,isMrcLayerEnabled:e.map.location.zoom>=((null===(t=e.config.layers.mrc)||void 0===t?void 0:t.zoomRange)&&(null===(n=e.config.layers.mrc)||void 0===n?void 0:n.zoomRange[0])||0),isMrcLayerShown:e.mrc.isLayerEnabled,areAdditionalLayersAvailable:!e.config.query.webview,panoramasPhotosLayer:Object(B.a)(e)}},H)),G=Object(i.a)("map-layers-view"),Z=function(e){function t(t){var n;return(n=e.call(this,t)||this)._bookmarksClosedAt=0,n._onLayerChange=function(e){n.props.updateMap({type:e})},n._onCloseBookmarks=function(){n._bookmarksClosedAt=Date.now(),n.setState({view:"layers"})},n._onMobileActionsClose=function(){Date.now()-n._bookmarksClosedAt<500||(n._bookmarksClosedAt=0,n.props.onClose())},n._onBookmarksClick=function(){n.props.config.authorization||n.props.onClose(),n.props.checkAuthorization("favorites",function(){n.setState({view:"bookmarks"})})},n._togglePanoramasPhotosLayer=function(){n.props.togglePanoramasPhotosLayer()},n._renderPopup=function(e){var t=n.props;return r.createElement(u.a,{getTarget:t.getTarget,position:["bottom","bottom-left"],restrictPosition:!0,type:"transparent",positionOffsets:{bottom:{main:12,side:0},"bottom-left":{main:12,side:20}},showArrow:!1,isShown:t.isShown,onClose:t.onClose,onMouseEnter:t.onMouseEnter,onMouseLeave:t.onMouseLeave},r.createElement("div",{className:G("popup-wrapper")},e))},n._renderParanja=function(e){var t=n.props;return r.createElement(m.a,{isShown:t.isShown,onClose:n._onMobileActionsClose,swipeable:!0},e)},n._renderModeButtons=function(){var e=n.props,t=v.c(e.trafficLevel,W),o=e.isMasstransitLayerShown&&e.isMasstransitLayerEnabledOnAnotherZoom?"Увеличьте масштаб, чтобы увидеть движущийся транспорт":e.isMasstransitLayerShown&&!e.isMasstransitLayerEnabled?"Нет информации о движении автобусов в этой области карты":"Движущийся транспорт";return r.createElement("div",{className:G("modes")},r.createElement(c.a,{name:"traffic",nodeState:{checked:e.isTrafficLayerEnabled},logClick:!0},r.createElement(N.a,{icon:function(){return r.createElement(b.a,{enabled:e.isTrafficLayerEnabled,level:e.trafficLevel})},iconStyle:{backgroundColor:e.isTrafficLayerEnabled?t:void 0},active:e.isTrafficLayerEnabled,onClick:e.toggleTrafficLayer},"Пробки")),r.createElement(d.a,{text:o,position:"left",isDisabled:!e.isMasstransitLayerShown||e.isMasstransitLayerEnabled&&!e.isMasstransitLayerEnabledOnAnotherZoom,isAir:!0},r.createElement(c.a,{name:"masstransit",nodeState:{checked:e.isMasstransitLayerShown},logClick:!0},r.createElement(N.a,{icon:"bus",active:e.isMasstransitLayerShown,onClick:e.toggleMasstransitLayer},"Движущийся транспорт"))),r.createElement(d.a,{text:"Парковки можно включить только на крупных масштабах карты",position:"left",isDisabled:e.isParkingLayerEnabled,isAir:!0,hideOnClick:!1},r.createElement(c.a,{name:"parking",nodeState:{checked:e.isParkingLayerShown},logClick:!0},r.createElement(N.a,{icon:"parking",active:e.isParkingLayerShown&&e.isParkingLayerEnabled,disabled:!e.isParkingLayerEnabled,onClick:e.isParkingLayerEnabled?e.toggleParkingLayer:void 0},"Парковки"))),r.createElement(c.a,{name:"mrc",nodeState:{checked:e.isMrcLayerEnabled},logClick:!0},r.createElement(N.a,{icon:"mirrors",active:e.isMrcLayerShown,disabled:!e.isMrcLayerShown&&!e.isMrcLayerEnabled,onClick:e.isMrcLayerShown?e.disableMrcLayer:e.enableMrcLayer},"Зеркала")),r.createElement(c.a,{name:"panoramas",nodeState:{checked:e.isPanoramasPhotosLayerEnabled},logClick:!0},r.createElement(N.a,{icon:"panorama",active:e.isPanoramasPhotosLayerEnabled,disabled:!e.isPanoramasPhotosLayerEnabled&&!e.isPanoramasLayerAvailable,onClick:n._togglePanoramasPhotosLayer},"Панорамы")))},n._renderToolsButtons=function(){var e=n.props;return r.createElement("div",{className:G("tools")},r.createElement(c.a,{name:"bookmarks",logClick:!0},r.createElement(N.a,{icon:"bookmark-filled",onClick:n._onBookmarksClick},"Закладки")),r.createElement(c.a,{name:"ruler",nodeState:{checked:e.isRulerEnabled},logClick:!0},r.createElement(N.a,{icon:"ruler",active:e.isRulerEnabled,disabled:e.isRulerBlocked,onClick:e.switchRuler},"Линейка")))},n._renderBookmarksMenu=function(){var e=n.props;return r.createElement(c.a,{name:"bookmarks_layers_menu"},r.createElement(U,{isShown:e.isShown,popupProps:{position:["bottom","bottom-left"],restrictPosition:!0,positionOffsets:{bottom:{main:12,side:0},"bottom-left":{main:12,side:20}},showArrow:!1,getTarget:e.getTarget,onClose:e.onClose,onMouseEnter:e.onMouseEnter,onMouseLeave:e.onMouseLeave},onClose:n._onCloseBookmarks}))},n._renderLayersMenu=function(){var e=n.props;return r.createElement(c.a,{name:"layers_panel"},r.createElement("div",{className:G()},r.createElement("div",{className:G("layers")},r.createElement(w,{layer:e.type,onChange:n._onLayerChange,size:"medium"})),e.areAdditionalLayersAvailable?r.createElement(r.Fragment,null,n._renderModeButtons(),n._renderToolsButtons()):null))},n.state={view:"layers"},n}Object(o.a)(t,e);var n=t.prototype;return n.componentDidUpdate=function(e){var t=this.props;t.config.authorization&&t.isShown&&t.initBookmarksManager(),e.isShown&&!t.isShown&&"bookmarks"===this.state.view&&this._onCloseBookmarks(),e.panoramasPhotosLayer&&!t.panoramasPhotosLayer&&t.updateMapControls({savedPanoramasPhotosLayer:e.panoramasPhotosLayer})},n.render=function(){var e=this.state,t=(this.props,this._renderPopup);switch(e.view){case"bookmarks":return this._renderBookmarksMenu();case"layers":return t(this._renderLayersMenu())}},t}(r.Component);t.default=q(Z)},1316:function(e,t,n){"use strict";n.r(t);var o=n(13),r=n(6),a=n(4),i=n(11),s=n(22),c=n(118),l=n(111),u=n(248),d=n(64),p=n(23),m=n(16),h=n(25),f=n(160),v=n(37),b=(n(1580),n(7)),E=n(735),_=n(162),g=n(451),y=n(126),k=n(9),C=n(12),w=n(34),S=n(252),L=n(1582),P=n.n(L),M=n(1583),R=n.n(M),T=Object(b.a)("whats-here-preview"),O={main:10,side:0},N=function(e){function t(){var t;return(t=e.apply(this,arguments)||this)._renderPanorama=function(){var e,n=null===(e=t.props.searchResults)||void 0===e?void 0:e.items[0],o=null==n?void 0:n.panorama;return n&&o?a.createElement("div",{className:T("panorama")},a.createElement(S.a,{panorama:o,view:"whatshere",onClick:t.props.onClose})):null},t._renderPopup=function(){var e=t.props,n=e.coordinates,o=e.zoom,r=e.searchResults,i=Object(v.a)(e,["coordinates","zoom","searchResults"]),s=null==r?void 0:r.items[0];if(!s)return a.createElement(g.a,{callback:i.onClose},a.createElement("div",null));var c=E.b.includes(s.kind)&&o>=16;return a.createElement(_.a,{coordinates:n,position:["top","bottom","left","right"],offset:O,onClose:i.onClose,showArrow:!1,isShown:!0},a.createElement(k.a,{name:"whatshere_preview"},a.createElement("div",{className:T()},a.createElement("div",{className:T("main")},a.createElement(k.a,{name:"title",logClick:!0},a.createElement("div",{className:T("info"),onClick:function(){return i.openWhatshere({coordinates:n,zoom:o,searchResults:r})}},a.createElement("div",{className:T("title")},s.title),a.createElement("div",{className:T("description")},s.description))),t._renderPanorama()),c?a.createElement("div",{className:T("links")},a.createElement(k.a,{name:"add_exact_address",logClick:!0},a.createElement("span",{className:T("add-object"),onClick:function(){return i.openAddObjectFeedback(n)}},"Добавить точный адрес"))):null,a.createElement("div",{className:T("line")}),a.createElement("div",{className:T("control")},a.createElement(k.a,{name:"route",logClick:!0},a.createElement("div",{className:T("control-route"),onClick:function(){return t.props.onRouteClick(s)}},a.createElement(C.a,{className:T("control-route-icon"),url:P.a}),"Маршрут")),a.createElement(k.a,{name:"nearby",logClick:!0},a.createElement("div",{className:T("control-search"),onClick:function(){return t.props.onSearchNearbyClick(s)}},a.createElement(C.a,{className:T("control-search-icon"),url:R.a}),"Искать рядом"))))))},t}return Object(r.a)(t,e),t.prototype.render=function(){var e,t=this.props,n=null===(e=t.searchResults)||void 0===e?void 0:e.items[0];return a.createElement(w.default,{coordinates:t.coordinates,nonInteractive:!0},this._renderPopup(),a.createElement("div",{className:T("placemark",{expanded:Boolean(n)})},a.createElement("div",{className:T("placemark-point")})),a.createElement(y.a,{type:"resize",listener:t.onClose}))},t}(a.Component),j=n(99),I=n(84),A={openCard:c.a.openCard,buildRouteTo:l.a.buildRouteTo,close:c.a.closeWhatsherePreview,updateWhatsherePreview:c.a.updateWhatsherePreview,setLoadingPanorama:u.a.setLoadingPanorama,setSearchFormType:s.a.setSearchFormType,searchNearby:j.a.searchNearby,openAddObjectFeedback:I.a.openAddObjectFeedback},D=i.b(function(e){var t=m.h(e,"routes");return{config:e.config,shouldIgnoreClick:e.ruler.isEnabled||e.panoramas.isLayerEnabled||e.photos.isLayerEnabled||e.map.isEditing||e.config.query.embed||Boolean(t&&t.routePoints.some(function(e){return!e.coords}))||e.mrc.isLayerEnabled||m.m(e.config),data:e.whatsherePreview,zoom:e.map.location.zoom}},A),z=function(e){function t(t){var n;return(n=e.call(this,t)||this)._mapAnalyticsRef=a.createRef(),n._canBeShown=!0,n._onDocumentMousedown=function(e){n.props.config.uatraits.isTouch&&"mousedown"===e.type||(n._canBeShown=!p.a.isShown())},n._onMapClick=function(e,t){var o=t.coordinates,r=n.props;if(!(r.shouldIgnoreClick||!n.state.handleMapClick||!n._canBeShown||p.a.isShown()||!1)){n._mapAnalyticsRef.current.logEvent("click");var a=r.zoom;0,n.setState({handleMapClick:!1}),r.updateWhatsherePreview({coordinates:o,from:"whatshere",zoom:a,origin:"whatshere"})}},n._onMapUpdate=function(){n.props.data&&n.props.close()},n._openWhatshere=function(e){var t,o=n.props,r={coordinates:e.coordinates,from:"whatshere",zoom:o.zoom};h.O(r),o.openCard(r,{response:null!==(t=e.searchResults)&&void 0!==t?t:void 0}),o.close()},n._onRouteClick=function(e){var t=n.props;t.buildRouteTo({value:e.title,coords:t.data.coordinates,searchResult:e}),t.close()},n._onSearchNearbyClick=function(e){n._openWhatshere(n.props.data);var t=h.q(e);n.props.searchNearby(t)},n._openAddObjectFeedback=function(e){var t=n.props;t.openAddObjectFeedback({type:"address/add",context:{formContextId:"toponym.building_without_address"},coordinates:e}),t.close()},n.state={handleMapClick:!0},n}Object(r.a)(t,e);var n=t.prototype;return n.componentDidMount=function(){window.document.addEventListener("mousedown",this._onDocumentMousedown,!0),window.document.addEventListener("touchstart",this._onDocumentMousedown,!0)},n.componentDidUpdate=function(e){var t=this;e.data&&!this.props.data&&setTimeout(function(){return t.setState({handleMapClick:!0})},500)},n.componentWillUnmount=function(){window.document.removeEventListener("mousedown",this._onDocumentMousedown,!0),window.document.removeEventListener("touchstart",this._onDocumentMousedown,!0)},n.render=function(){var e=this.props;return a.createElement(a.Fragment,null,e.data?a.createElement(N,Object(o.a)({},e.data,{zoom:e.zoom,onClose:e.close,openAddObjectFeedback:this._openAddObjectFeedback,openWhatshere:this._openWhatshere,onRouteClick:this._onRouteClick,onSearchNearbyClick:this._onSearchNearbyClick})):null,a.createElement(f.default,{name:"whatshere_preview_layer",nodeRef:this._mapAnalyticsRef}),a.createElement(d.default,{onUpdate:this._onMapUpdate,onClick:this._onMapClick}))},t}(a.Component);z.displayName="WhatsHerePreviewComponent";t.default=D(z)},1317:function(e,t,n){"use strict";n.r(t);var o=n(4),r=n(11),a=n(14),i=n(831),s={pmbl:"#177ee6",pmrd:"#f43",pmgn:"#3bb300"},c=s.pmbl,l=function(e){return e.points?o.createElement(o.Fragment,null,e.points.map(function(e,t){var n=e.coordinates,r=e.color;return o.createElement(i.a,{key:t+"_"+n.join(),coordinates:n,color:r&&r in s?s[r]:c,nonInteractive:!0,comma:!0})})):null},u=Object(a.a)(r.b(function(e){return e.placemarks}));t.default=u(function(e){return o.createElement(l,{points:e.points})})},1574:function(e,t,n){},1580:function(e,t,n){},1582:function(e,t,n){e.exports=n.p+"_/8d48e291dc0757f5017f05b1c6c24bc4.svg"},1583:function(e,t,n){e.exports=n.p+"_/645e798bb0a130dcf7aba57ec4f27e16.svg"},162:function(e,t,n){"use strict";var o=n(13),r=n(37),a=n(6),i=n(4),s=n(34),c=n(64),l=n(23),u=function(e){function t(){var t;return(t=e.apply(this,arguments)||this)._ref=i.createRef(),t._onMapUpdate=function(){t.forceUpdate()},t}return Object(a.a)(t,e),t.prototype.render=function(){var e=this,t=this.props,n=t.coordinates,a=Object(r.a)(t,["coordinates"]);return i.createElement(i.Fragment,null,i.createElement(s.default,{coordinates:n,nonInteractive:!0},i.createElement("div",{ref:this._ref}),i.createElement(l.a,Object(o.a)({type:"balloon"},a,{getTarget:function(){return e._ref.current}}),a.children)),i.createElement(c.default,{onUpdate:a.isShown?this._onMapUpdate:void 0}))},t}(i.PureComponent);t.a=u},212:function(e,t,n){},235:function(e,t,n){"use strict";var o=n(27);t.a=Object(o.a)(function(){return n.e("preview").then(n.bind(null,536))},{showUriPreview:!0,showOrgPreview:!0,showStopPreview:!0,showPreloadedPreview:!0,hidePreview:!0,cancelHidePreview:!0,showRealtyPreview:!0})},2424:function(e,t,n){},2426:function(e,t,n){},2428:function(e,t,n){},2430:function(e,t,n){},252:function(e,t,n){"use strict";var o=n(6),r=(n(303),n(4)),a=n(11),i=n(7),s=n(248),c=n(9),l=n(77),u=n(103),d={setLoadingPanorama:s.a.setLoadingPanorama},p=Object(i.a)("panorama-thumbnail-view"),m=a.b(function(e){return{config:e.config}},d),h=function(e){function t(){var t;return(t=e.apply(this,arguments)||this)._onClick=function(){var e,n;t.props.setLoadingPanorama({id:t.props.panorama.id,direction:t.props.panorama.direction}),null===(e=(n=t.props).onClick)||void 0===e||e.call(n)},t}return Object(o.a)(t,e),t.prototype.render=function(){var e=this.props;return r.createElement(c.a,{name:"panorama",metrikaGoal:"goal_deepuse",logClick:!0},r.createElement("div",{className:p({view:e.view}),onClick:this._onClick},r.createElement(u.a,{src:e.panorama.preview,alt:e.panorama.alt,backgroundSize:"cover",renderImmediately:!0}),r.createElement("div",{className:p("label")},"preview"===e.view?"Панорама":""),r.createElement(l.a,{chunk:"panoramas"})))},t}(r.Component);t.a=m(h)},282:function(e,t,n){"use strict";var o={setLayer:function(e){return function(t,n){t({type:"DEEP_EXTEND",payload:e?{parking:{isLayerShown:n().parking.isLayerEnabled},traffic:{isLayerEnabled:!1},panoramas:{isLayerEnabled:!1},photos:{isLayerEnabled:!1},mrc:{isLayerEnabled:!1}}:{parking:{isLayerShown:!1}}})}},toggleLayer:function(){return function(e,t){if(t().parking.isLayerShown)return e(o.setLayer(!1));e(o.setLayer(!0))}},updateLayerAvailability:function(e){return{type:"DEEP_EXTEND",payload:{parking:e}}}};t.a=o},30:function(e,t,n){"use strict";n.d(t,"a",function(){return o});var o={screenshotDialog:99999,ruler:8030,editing:8030,hover:8020,active:8e3,search:{active:8e3,subtitle:7500,title:7e3,base:6500,dot:6e3},dialog:2e3,usermaps:{placemark:3e3,line:2e3,polygon:1e3},discovery:580,routes:550,routePins:{waypoint:8e3,masstransit:7900},masstransitStop:8001,moving:500,masstransitLineStop:510,home:451,work:450,default:400,tooltip:352,masstransitRegion:350,bookmarks:300,minimum:1}},303:function(e,t,n){},34:function(e,t,n){"use strict";n.r(t);var o=n(87),r=n(6),a=(n(71),n(4)),i=n(5),s=n(7),c=n(31),l=n(30),u=n(62),d=300,p=Object(s.a)("map-placemark"),m=function(){},h=function(e){function t(t){var n;return(n=e.call(this,t)||this)._container=document.createElement("div"),n._isDragged=!1,n._initCursor=function(){n._updateCursor(),n._marker.group().on("dragStart",function(){n._isDragged=!0,n._container.style.cursor="grabbing",n.props.map.container.style.cursor="grabbing"}).on("dragEnd",function(){n._isDragged=!1,n._updateCursor(),n.props.map.container.style.cursor="default"})},n._updateCursor=function(){n._container.style.cursor=n.props.onClick||n.props.onMouseEnter||n.props.draggable?"pointer":"default"},n._addMapEventHandlers=function(e){var t={dragStart:e.onDragStart,dragMove:e.onDragMove,dragEnd:e.onDragEnd};Object.keys(t).forEach(function(e){t[e]&&n._mapEventHandlers.on(e,function(){t[e]({coordinates:n._marker.coordinates})})})},n._onClick=function(e){e.stopPropagation();var t=n.props,o=t.onClick||m,r=t.onFastClick||m,a=t.onDoubleClick||m;n._clickTimer?(a(),window.clearTimeout(n._clickTimer),n._clickTimer=void 0):(r(),n._clickTimer=window.setTimeout(function(){o(),n._clickTimer=void 0},d))},n._container.className=p(),n._marker=t.map.createMarker({coordinates:t.coordinates,element:n._container,options:{draggable:t.draggable,zIndex:t.zIndex||l.a.default,disableRoundCoordinates:t.disableRoundCoordinates,blockEvents:t.blockEvents}}),n._mapEventHandlers=n._marker.group(),n}Object(r.a)(t,e);var n=t.prototype;return n.componentDidMount=function(){var e=this.props;this._initCursor(),this._addMapEventHandlers(e),e.map.addMarker(this._dataSourceId,this._marker)},n.componentWillUnmount=function(){this.props.map.destroyed||(this._mapEventHandlers.offAll(),this.props.map.removeMarker(this._dataSourceId,this._marker),this._marker.destroy(),this._isDragged&&(this.props.map.container.style.cursor="default")),window.clearTimeout(this._clickTimer)},n.componentDidUpdate=function(e){var t=e.dataSourceId?e.dataSourceId:u.d.DEFAULT_MARKERS;t!==this._dataSourceId&&(this.props.map.removeMarker(t,this._marker),this.props.map.addMarker(this._dataSourceId,this._marker));var n=this.props;n.coordinates!==e.coordinates&&this._marker.setCoordinates(n.coordinates),e.draggable!==n.draggable&&this._marker.toggleDrag(n.draggable||!1),e.zIndex!==n.zIndex&&this._marker.setZIndex(n.zIndex||l.a.default),e.disableRoundCoordinates!==n.disableRoundCoordinates&&this._marker.toggleRoundCoordinates(n.disableRoundCoordinates||!1),n.onDragStart===e.onDragStart&&n.onDragMove===e.onDragMove&&n.onDragEnd===e.onDragEnd||(this._mapEventHandlers.offAll(),this._addMapEventHandlers(n)),e.draggable===n.draggable&&e.onClick===n.onClick||this._updateCursor()},n.render=function(){var e=this.props,t=a.createElement("div",{className:p("wrapper",{"non-interactive":e.nonInteractive}),onClick:this._onClick,onMouseEnter:e.onMouseEnter,onMouseLeave:e.onMouseLeave,onMouseMove:e.onMouseMove},e.children);return i.createPortal(t,this._container)},Object(o.a)(t,[{key:"_dataSourceId",get:function(){return this.props.dataSourceId||u.d.DEFAULT_MARKERS}}]),t}(a.PureComponent);t.default=Object(c.b)({shouldWait:!0})(h)},45:function(e,t,n){"use strict";var o=n(6),r=(n(73),n(4)),a=n(7),i=n(85),s=n(61),c=1,l=Object(a.a)("sticky-wrapper"),u=function(e){function t(t){var n;return(n=e.call(this,t)||this)._containerRef=r.createRef(),n._isDisabled=function(e){return void 0===e&&(e=n.props),e.disabled||!e.scrollId},n._registerContainer=function(){var e,t=n.props,o=null!==(e=t.order)&&void 0!==e?e:c;if(n._containerRef.current){if(!t.scrollId)return;t.registerStickyElement(o,n._containerRef,n._onPositionUpdate),t.updateStickyElement(o,n._containerRef.current.offsetHeight),n._unregisterContainer=function(){t.unregisterStickyElement(o)}}},n._onIntersectionChange=function(e){n.setState({fixed:!e})},n._onPositionUpdate=function(e){var t,o;n.setState({position:e}),null===(t=(o=n.props).onOffsetChange)||void 0===t||t.call(o,e)},n._onIntersectionParentBoundaries=function(e){n.setState({reachedParentBoundaries:!e})},n.state={fixed:!1,reachedParentBoundaries:!1,position:0},n}Object(o.a)(t,e);var n=t.prototype;return n.componentDidMount=function(){this._isDisabled()||this._registerContainer()},n.componentDidUpdate=function(e,t){var n=this.props,o=this.state,r=n.children!==e.children;(n.children&&r||this._isDisabled(e)&&!this._isDisabled())&&this._registerContainer(),n.onFixedChange&&t.fixed!==o.fixed&&n.onFixedChange(o.fixed)},n.componentWillUnmount=function(){var e;null===(e=this._unregisterContainer)||void 0===e||e.call(this)},n.render=function(){var e,t=this.props,n=this.state;return t.children?this._isDisabled()?"always"===this.props.border?r.createElement("div",{className:l("pseudo-sticky")},t.children):t.children:r.createElement(r.Fragment,null,"top"===t.position?r.createElement(s.a,{threshold:0,style:n.position?{transform:"translateY(-"+n.position+"px)"}:void 0,className:l("observer-target"),onChange:this._onIntersectionChange},null):null,r.createElement("div",{className:l({position:t.position,fixed:n.fixed,header:t.header,border:null!==(e=t.border)&&void 0!==e?e:"auto",wide:t.wide,"reached-boundaries":n.reachedParentBoundaries,empty:!t.children}),style:{top:this.state.position,zIndex:t.zIndex},ref:this._containerRef},r.createElement(s.a,{threshold:0,style:n.position?{transform:"translateY(-"+n.position+"px)"}:void 0,className:l("observer-target",{absolute:!0}),onChange:this._onIntersectionParentBoundaries},null),t.children)):null},t}(r.Component);t.a=Object(i.b)(u)},66:function(e,t){},68:function(e,t,n){"use strict";var o=n(6),r=n(4),a=n(61),i=n(8),s=function(e){function t(t){var n;return(n=e.call(this,t)||this).state={shouldRender:t.immediately||Boolean(t.config.uatraits.isRobot)||t.config.query["no-lazy-render"]},n}Object(o.a)(t,e);var n=t.prototype;return n.componentDidUpdate=function(e){!e.immediately&&this.props.immediately&&this.setState({shouldRender:!0})},n.render=function(){var e=this,t=this.props;if(this.state.shouldRender)return this.props.children;var n=t.placeholder||null;return r.createElement(a.a,{style:{width:"100%",height:"100%"},rootMargin:t.rootMargin||"100px",onChange:function(t){return e.setState({shouldRender:t})}},n)},t}(r.PureComponent);t.a=Object(i.b)(s)},71:function(e,t,n){},73:function(e,t,n){},750:function(e,t,n){"use strict";n(924);var o=n(4),r=n(7),a=n(382),i=Object(r.a)("traffic-icon");t.a=function(e){var t=e.size||"normal",n=e.enabled&&"number"==typeof e.level?a.b(e.level):null;return o.createElement("div",{className:i({color:n,size:t})},o.createElement("div",{className:i("text")},e.enabled?e.level:null))}},77:function(e,t,n){"use strict";var o=n(6),r=n(4),a=n(8),i=n(208),s=function(e){function t(){return e.apply(this,arguments)||this}Object(o.a)(t,e);var n=t.prototype;return n.componentDidMount=function(){var e=this;if(!this.props.config.experiments.ui.noPreloadChunk){var t=function(){return i.a(e.props.chunk)};this.props.immediately?t():setTimeout(t,3e3)}},n.render=function(){return null},t}(r.Component);t.a=Object(a.b)(s)},83:function(e,t,n){"use strict";var o=n(10),r=n(2977),a=n(46),i=n(125),s=n(151);n.d(t,"f",function(){return f}),n.d(t,"b",function(){return v}),n.d(t,"c",function(){return b}),n.d(t,"d",function(){return E}),n.d(t,"e",function(){return _}),n.d(t,"g",function(){return g}),n.d(t,"i",function(){return y}),n.d(t,"h",function(){return k}),n.d(t,"k",function(){return d}),n.d(t,"p",function(){return C}),n.d(t,"o",function(){return w}),n.d(t,"a",function(){return S}),n.d(t,"n",function(){return L}),n.d(t,"l",function(){return P}),n.d(t,"j",function(){return M}),n.d(t,"m",function(){return R});var c,l={"ymapsbm1://pin":"pin","ymapsbm1://geo":"toponym","ymapsbm1://org":"business"},u=500;function d(e,t){return{home:"Дом",work:"Работа"}[e]}var p=function(e){return c||(c=i.a.getLib(e).then(function(e){return e.getSearchHistoryManager()})),c};function m(e,t){return"children"in t?t.children.map(function(t){return m(e,t)}).find(Boolean)||null:e(t)?t:null}function h(e,t){return"children"in t?e(t)?t:t.children.find(function(t){return"children"in t&&Boolean(h(e,t))})||null:null}function f(e,t){return h(function(t){return t.id===e},t)}function v(e,t){return m(function(t){return t.id===e},t)}function b(e,t){return m(function(t){return t.uri===e},t)}function E(e,t){return b(a.g(e),t)||function(e,t){return m(function(t){var n=a.e(t.uri);return a.k(t.uri)&&null!==n&&Object(r.a)(n,e.coordinates)},t)}({coordinates:e.displayCoordinates},t)}function _(e,t){return h(function(t){return t.children.some(function(t){return e===t.id})},t)}function g(e){return"children"in e?e.children.reduce(function(e,t){return e.concat(g(t))},[]):[e]}function y(e,t){return e.children.reduce(function(e,n){var o;return(null===(o=n.tags)||void 0===o?void 0:o.includes(t))?e.concat(g(n)):e},[])}function k(e){var t=e.uri,n=Object.keys(l).find(function(e){return t.includes(e)});return n?l[n]:"unknown"}function C(e,t){var n=e.text.trim();t.authorization&&n&&p(t).then(function(t){t.addRecord({text:n,uri:e&&e.uri})}).catch(function(){})}function w(e){return e.authorization?Promise.race([p(e).then(function(e){return e.getRecords()}),s.a(u)]).catch(function(){return[]}):Promise.resolve([])}function S(e){return e.authorization?p(e).then(function(e){return e.deleteRecords()}):Promise.reject()}function L(e){return"coords"in e}function P(e,t){return e.id===i.a.FAVORITES_FOLDER_ID?"Избранное":e.title}function M(e){return("create_folder"===e.type||"edit_folder"===e.type)&&e.isShownIconSelection?"select_folder_icon":e.type}function R(e){switch(e.type){case"create_folder":return Object(o.a)({type:e.type,values:{title:"",description:""}},e.data);case"edit_folder":return Object(o.a)({type:e.type},e.data);case"rename_bookmark":return{type:e.type,bookmark:e.bookmark}}return null}},831:function(e,t,n){"use strict";var o=n(37),r=(n(832),n(4)),a=n(7),i=n(34),s=n(12),c=n(834),l=n.n(c),u=n(835),d=n.n(u),p=Object(a.a)("map-circle-placemark");t.a=function(e){var t=e.color,n=e.size,a=void 0===n?"medium":n,c=e.comma,u=e.caption,m=e.outline,h=Object(o.a)(e,["color","size","comma","caption","outline"]);return r.createElement(i.default,h,r.createElement("div",{className:p({comma:c,size:a,outline:m}),style:{color:t}},r.createElement(s.a,{className:p("placemark"),url:c?d.a:l.a}),r.createElement("div",{className:p("content")},e.children),u?r.createElement("div",{className:p("caption")},u):null))}},832:function(e,t,n){},834:function(e,t,n){e.exports=n.p+"_/ebe60c9063e4a91162d1366e790ea391.svg"},835:function(e,t,n){e.exports=n.p+"_/fd161c881e6392111418a1036fe1188e.svg"},924:function(e,t,n){},997:function(e,t,n){"use strict";var o=n(13),r=n(6),a=n(4),i=n(8),s=n(23),c=(n(66),function(e){function t(t){var n;return(n=e.call(this,t)||this)._onScroll=function(e){var t=e<=0;t!==n.state.isScrollOnTop&&n.setState({isScrollOnTop:t})},n._isNodeWithinStickyElement=function(e,t){return"sticky"===window.getComputedStyle(e).position||!(e===t||!e.parentElement)&&n._isNodeWithinStickyElement(e.parentElement,t)},n._isSwipeDisabled=function(e){var t=!n.state.isScrollOnTop;return t&&e.target?!n._isNodeWithinStickyElement(e.target,e.currentTarget):t},n._renderContent=function(){return n.props.children({onScroll:n._onScroll})},n.state={isScrollOnTop:!1},n}return Object(r.a)(t,e),t.prototype.render=function(){var e=this.props;return a.createElement(s.a,Object(o.a)({isShown:e.isShown,type:"transparent",onClose:e.onClose},e.popupProps),this._renderContent())},t}(a.Component));t.a=Object(i.b)(c)}}]);